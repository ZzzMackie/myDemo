"use strict";var root=window.player,nowIndex=0,len=void 0,A=void 0,B=void 0,I=void 0,C=void 0,cT=void 0,per=void 0,timer=void 0,lastLen=void 0,duration=void 0,dataList=void 0,audio=root.audioManager,Index=root.newIndex;function getData(){return new Promise(function(o,a){$.ajax({type:"GET",url:"mock/data.json",success:function(t){o(t)},error:function(t){a(t)}})})}function bindEvent(){$("body").on("play:change",function(t,o){root.renDom(dataList[o]),A.getAudio(dataList[o].audio),duration=dataList[o].duration,"play"===A.status&&(A.play(),root.boot.start(0),rotate(0)),$(".img-box").attr("data-deg",0),$(".img-box").css({transform:"rotateZ(0deg)",transition:"none"})}),$(".prev").on("click",function(t){"pause"===A.status&&($(".play").addClass("playing"),root.boot.start(0)),A.play(),I=B.prev(),$("body").trigger("play:change",I),root.boot.stop()}),$(".next").on("click",function(t){"pause"===A.status&&($(".play").addClass("playing"),root.boot.start(0)),A.play(),I=B.next(),$("body").trigger("play:change",I),root.boot.stop()}),$(".play").on("click",function(t){"pause"===A.status?(rotate($(".img-box").attr("data-deg")||0),A.play(),root.boot.start()):(A.pause(),root.boot.stop(),clearInterval(timer));$(".play").toggleClass("playing")}),$(".meaun").on("click",function(t){var o=$(".item");$(".meaun").toggleClass("list"),o.toggleClass("fadein")}),$("li").each(function(o,t){$(t).on("click",function(t){root.renDom(dataList[o]),A.getAudio(dataList[o].audio),"pause"===A.status&&$(".play").addClass("playing"),rotate(0),A.play(),root.boot.start()})}),$(".likes").on("click",function(t){dataList.forEach(function(t,o){var a=$(".song-name").html(),n=$(".likes").hasClass("like");a==t.song&&(t.isLike=!n)}),$(".likes").toggleClass("like")})}function rotate(t){clearInterval(timer);var o=parseInt(t);timer=setInterval(function(){o+=1,$(".img-box").attr("data-deg",o),$(".img-box").css({transtion:"transform 0.5s linear",transform:"rotateZ("+o+"deg)"})},100)}function touchEvent(){$(".item-list").on("touchstart",function(t){t.stopPropagation();var o=$(".item").offset(),a=(o.top,$(".item-list").offset().height-o.height),n=t.touches[0].clientY;$(".item-list").on("touchmove",function(t){t.stopPropagation(),t.preventDefault();var o=t.touches[0].clientY-n;o<-a?$(".item-list").css({top:"-"+a+"px"}):20<o?$(".item-list").css({top:"0px"}):$(".item-list").css({top:o+"px"})})})}function dragTimer(){var a=$(".pro-bottom").offset().left,n=$(".pro-bottom").offset().width;$(".slider").on("touchstart",function(t){root.boot.stop(),A.pause()}).on("touchmove",function(t){var o=t.touches[0].clientX-a;cT=(per=o/n)*duration,0<=per&&per<1&&root.boot.upDate(per)}).on("touchend",function(t){0<=per&&per<1&&(A.playTo(cT),A.play(),root.boot.start(per),$(".play").addClass("playing"))}),$(C).on("ended",function(){$(".next").trigger("click")})}getData().then(function(t){len=(dataList=t).length,lastLen=t.length-1,B=new Index(len),A=new audio,duration=t[0].duration,C=A.audio,root.renDomList(t),root.renDom(t[0]),A.getAudio(dataList[0].audio),bindEvent(),touchEvent(),dragTimer()}).catch(function(t){});